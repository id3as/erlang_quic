searchData={"items":[{"type":"module","title":"quic","doc":"QUIC public API. This module provides the public interface for QUIC connections. The API is compatible with hackney_quic for drop-in replacement. Messages Messages sent to owner process: {quic, ConnRef, {connected, Info}}  - Connection established {quic, ConnRef, {stream_opened, StreamId}}  - Stream opened {quic, ConnRef, {closed, Reason}}  - Connection closed {quic, ConnRef, {transport_error, Code, Reason}}  - Transport error {quic, ConnRef, {stream_data, StreamId, Bin, Fin}}  - Data received {quic, ConnRef, {stream_reset, StreamId, ErrorCode}}  - Stream reset {quic, ConnRef, {stop_sending, StreamId, ErrorCode}}  - Stop sending {quic, ConnRef, {goaway, LastStreamId, ErrorCode, Debug}}  - GoAway received {quic, ConnRef, {session_ticket, Ticket}}  - Session ticket for 0-RTT {quic, ConnRef, {send_ready, StreamId}}  - Stream ready to write {quic, ConnRef, {timer, NextTimeoutMs}}  - Timer notification {quic, ConnRef, {datagram, Data}}  - Datagram received (RFC 9221)","ref":"quic.html"},{"type":"function","title":"quic.close/2","doc":"Close a QUIC connection.","ref":"quic.html#close/2"},{"type":"function","title":"quic.connect/4","doc":"Connect to a QUIC server. Returns {ok, ConnRef} on success where ConnRef is a reference(). The owner process will receive {quic, ConnRef, {connected, Info}} when the connection is established. Options: socket_fd  - Use an existing UDP socket FD (see  get_fd/1 ) verify  - Verify server certificate (default: false) alpn  - ALPN protocols (default: [<<\"h3\">>]) sni  - Server Name Indication (default: Host)","ref":"quic.html#connect/4"},{"type":"function","title":"quic.get_fd/1","doc":"Get the file descriptor from a gen_udp socket. This can be used to pass an existing UDP socket to connect/4 via the  socket_fd  option.","ref":"quic.html#get_fd/1"},{"type":"function","title":"quic.handle_timeout/2","doc":"Handle connection timeout. Should be called when timer expires. Returns next timeout in ms or 'infinity'.","ref":"quic.html#handle_timeout/2"},{"type":"function","title":"quic.is_available/0","doc":"Check if QUIC support is available. Always returns true for pure Erlang implementation.","ref":"quic.html#is_available/0"},{"type":"function","title":"quic.open_stream/1","doc":"Open a new bidirectional stream. Returns {ok, StreamId} on success.","ref":"quic.html#open_stream/1"},{"type":"function","title":"quic.open_unidirectional_stream/1","doc":"Open a new unidirectional stream. Returns {ok, StreamId} on success. Unidirectional streams are send-only for the initiator.","ref":"quic.html#open_unidirectional_stream/1"},{"type":"function","title":"quic.peercert/1","doc":"Get the peer certificate. Returns the DER-encoded certificate of the peer if available.","ref":"quic.html#peercert/1"},{"type":"function","title":"quic.peername/1","doc":"Get the remote address of the connection.","ref":"quic.html#peername/1"},{"type":"function","title":"quic.process/1","doc":"Process pending QUIC events. This is called automatically by the connection process. Returns the next timeout in milliseconds, or 'infinity'.","ref":"quic.html#process/1"},{"type":"function","title":"quic.reset_stream/3","doc":"Reset a stream with an error code.","ref":"quic.html#reset_stream/3"},{"type":"function","title":"quic.send_data/4","doc":"Send data on a stream. Fin indicates if this is the final frame on the stream.","ref":"quic.html#send_data/4"},{"type":"function","title":"quic.send_datagram/2","doc":"Send a datagram on the connection. Datagrams are unreliable and may be lost.","ref":"quic.html#send_datagram/2"},{"type":"function","title":"quic.set_owner/2","doc":"Set the owner process for a connection. Similar to gen_tcp:controlling_process/2.","ref":"quic.html#set_owner/2"},{"type":"function","title":"quic.setopts/2","doc":"Set connection options.","ref":"quic.html#setopts/2"},{"type":"function","title":"quic.sockname/1","doc":"Get the local address of the connection.","ref":"quic.html#sockname/1"},{"type":"module","title":"quic_listener","doc":"QUIC server listener for accepting connections. This module handles: - UDP socket management - Initial packet routing to connections - Connection ID management - Stateless retry (optional) Connection Handler Callback The  connection_handler  option allows custom handling of new connections: <span class=\"w\">   </span><span class=\"n\">Opts</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\" data-group-id=\"0364192260-1\">#{</span><span class=\"w\">\n       </span><span class=\"ss\">cert</span><span class=\"w\"> </span><span class=\"p\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Cert</span><span class=\"p\">,</span><span class=\"w\">\n       </span><span class=\"ss\">key</span><span class=\"w\"> </span><span class=\"p\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Key</span><span class=\"p\">,</span><span class=\"w\">\n       </span><span class=\"ss\">connection_handler</span><span class=\"w\"> </span><span class=\"p\">=&gt;</span><span class=\"w\"> </span><span class=\"nf\">fun</span><span class=\"p\" data-group-id=\"0364192260-2\">(</span><span class=\"n\">ConnPid</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ConnRef</span><span class=\"p\" data-group-id=\"0364192260-2\">)</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\">\n           </span><span class=\"c1\">%% Spawn your handler and return its pid</span><span class=\"w\">\n           </span><span class=\"n\">HandlerPid</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">spawn</span><span class=\"p\" data-group-id=\"0364192260-3\">(</span><span class=\"nf\">fun</span><span class=\"p\" data-group-id=\"0364192260-4\">(</span><span class=\"p\" data-group-id=\"0364192260-4\">)</span><span class=\"w\"> </span><span class=\"p\">-&gt;</span><span class=\"w\"> </span><span class=\"nf\">my_handler</span><span class=\"p\" data-group-id=\"0364192260-5\">(</span><span class=\"n\">ConnPid</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ConnRef</span><span class=\"p\" data-group-id=\"0364192260-5\">)</span><span class=\"w\"> </span><span class=\"k\">end</span><span class=\"p\" data-group-id=\"0364192260-3\">)</span><span class=\"p\">,</span><span class=\"w\">\n           </span><span class=\"c1\">%% Ownership will be transferred to HandlerPid</span><span class=\"w\">\n           </span><span class=\"p\" data-group-id=\"0364192260-6\">{</span><span class=\"ss\">ok</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">HandlerPid</span><span class=\"p\" data-group-id=\"0364192260-6\">}</span><span class=\"w\">\n       </span><span class=\"k\">end</span><span class=\"w\">\n   </span><span class=\"p\" data-group-id=\"0364192260-1\">}</span>","ref":"quic_listener.html"},{"type":"function","title":"quic_listener.code_change/3","doc":"","ref":"quic_listener.html#code_change/3"},{"type":"function","title":"quic_listener.get_connections/1","doc":"Get list of active connections.","ref":"quic_listener.html#get_connections/1"},{"type":"function","title":"quic_listener.get_port/1","doc":"Get the port the listener is bound to.","ref":"quic_listener.html#get_port/1"},{"type":"function","title":"quic_listener.handle_call/3","doc":"","ref":"quic_listener.html#handle_call/3"},{"type":"function","title":"quic_listener.handle_cast/2","doc":"","ref":"quic_listener.html#handle_cast/2"},{"type":"function","title":"quic_listener.handle_info/2","doc":"","ref":"quic_listener.html#handle_info/2"},{"type":"function","title":"quic_listener.init/1","doc":"","ref":"quic_listener.html#init/1"},{"type":"function","title":"quic_listener.start/2","doc":"Start a QUIC listener (without linking to caller).","ref":"quic_listener.html#start/2"},{"type":"function","title":"quic_listener.start_link/2","doc":"Start a QUIC listener on the given port. Options: - cert: Server certificate (DER binary) - cert_chain: Certificate chain [binary()] - key: Private key - alpn: List of supported ALPN protocols","ref":"quic_listener.html#start_link/2"},{"type":"function","title":"quic_listener.stop/1","doc":"Stop the listener.","ref":"quic_listener.html#stop/1"},{"type":"function","title":"quic_listener.terminate/2","doc":"","ref":"quic_listener.html#terminate/2"},{"type":"module","title":"quic_connection","doc":"QUIC connection state machine implemented as gen_statem. This module manages the lifecycle of a QUIC connection, handling: - TLS 1.3 handshake via CRYPTO frames - Packet encryption/decryption at each level - Stream management - Flow control - Timer management Connection States idle -> handshaking -> connected -> draining -> closed Messages to Owner {quic, ConnRef, {connected, Info}} {quic, ConnRef, {stream_data, StreamId, Data, Fin}} {quic, ConnRef, {stream_opened, StreamId}} {quic, ConnRef, {closed, Reason}}","ref":"quic_connection.html"},{"type":"function","title":"quic_connection.callback_mode/0","doc":"","ref":"quic_connection.html#callback_mode/0"},{"type":"function","title":"quic_connection.close/2","doc":"Close the connection.","ref":"quic_connection.html#close/2"},{"type":"function","title":"quic_connection.close_stream/3","doc":"Close a specific stream.","ref":"quic_connection.html#close_stream/3"},{"type":"function","title":"quic_connection.closed/3","doc":"","ref":"quic_connection.html#closed/3"},{"type":"function","title":"quic_connection.code_change/4","doc":"","ref":"quic_connection.html#code_change/4"},{"type":"function","title":"quic_connection.connect/4","doc":"Initiate a connection to a QUIC server. This is a convenience wrapper that starts the process and initiates handshake.","ref":"quic_connection.html#connect/4"},{"type":"function","title":"quic_connection.connected/3","doc":"","ref":"quic_connection.html#connected/3"},{"type":"function","title":"quic_connection.draining/3","doc":"","ref":"quic_connection.html#draining/3"},{"type":"function","title":"quic_connection.get_state/1","doc":"Get current connection state (for debugging).","ref":"quic_connection.html#get_state/1"},{"type":"function","title":"quic_connection.handle_timeout/1","doc":"Handle a timeout event.","ref":"quic_connection.html#handle_timeout/1"},{"type":"function","title":"quic_connection.handle_timeout/2","doc":"Handle a timeout event with timestamp. The NowMs parameter is currently unused as the connection manages its own timing internally.","ref":"quic_connection.html#handle_timeout/2"},{"type":"function","title":"quic_connection.handshaking/3","doc":"","ref":"quic_connection.html#handshaking/3"},{"type":"function","title":"quic_connection.idle/3","doc":"","ref":"quic_connection.html#idle/3"},{"type":"function","title":"quic_connection.init/1","doc":"","ref":"quic_connection.html#init/1"},{"type":"function","title":"quic_connection.key_update/1","doc":"Initiate a key update (RFC 9001 Section 6). This triggers a key update cycle, deriving new encryption keys. Only valid when connection is in connected state.","ref":"quic_connection.html#key_update/1"},{"type":"function","title":"quic_connection.lookup/1","doc":"Lookup a connection pid by reference.","ref":"quic_connection.html#lookup/1"},{"type":"function","title":"quic_connection.open_stream/1","doc":"Open a new bidirectional stream.","ref":"quic_connection.html#open_stream/1"},{"type":"function","title":"quic_connection.open_unidirectional_stream/1","doc":"Open a new unidirectional stream.","ref":"quic_connection.html#open_unidirectional_stream/1"},{"type":"function","title":"quic_connection.peercert/1","doc":"Get peer certificate (DER-encoded).","ref":"quic_connection.html#peercert/1"},{"type":"function","title":"quic_connection.peername/1","doc":"Get remote address.","ref":"quic_connection.html#peername/1"},{"type":"function","title":"quic_connection.process/1","doc":"Process pending events (called when socket is ready).","ref":"quic_connection.html#process/1"},{"type":"function","title":"quic_connection.register_conn/2","doc":"Register a connection reference to a pid.","ref":"quic_connection.html#register_conn/2"},{"type":"function","title":"quic_connection.reset_stream/3","doc":"Reset a stream.","ref":"quic_connection.html#reset_stream/3"},{"type":"function","title":"quic_connection.send_data/4","doc":"Send data on a stream.","ref":"quic_connection.html#send_data/4"},{"type":"function","title":"quic_connection.send_datagram/2","doc":"Send a datagram.","ref":"quic_connection.html#send_datagram/2"},{"type":"function","title":"quic_connection.set_owner/2","doc":"Set new owner process.","ref":"quic_connection.html#set_owner/2"},{"type":"function","title":"quic_connection.setopts/2","doc":"Set connection options.","ref":"quic_connection.html#setopts/2"},{"type":"function","title":"quic_connection.sockname/1","doc":"Get local address.","ref":"quic_connection.html#sockname/1"},{"type":"function","title":"quic_connection.start_link/4","doc":"Start a QUIC connection process.","ref":"quic_connection.html#start_link/4"},{"type":"function","title":"quic_connection.start_link/5","doc":"Start a QUIC connection with optional pre-opened socket.","ref":"quic_connection.html#start_link/5"},{"type":"function","title":"quic_connection.start_server/1","doc":"Start a server-side QUIC connection. Called by quic_listener when a new connection is accepted.","ref":"quic_connection.html#start_server/1"},{"type":"function","title":"quic_connection.terminate/3","doc":"","ref":"quic_connection.html#terminate/3"},{"type":"function","title":"quic_connection.unregister_conn/1","doc":"Unregister a connection reference.","ref":"quic_connection.html#unregister_conn/1"},{"type":"module","title":"quic_stream","doc":"QUIC stream state management. This module manages individual stream state, including: - Stream lifecycle (idle -> open -> half-closed -> closed) - Send and receive buffers - Per-stream flow control - Data ordering and reassembly Stream Types Stream IDs encode the initiator and directionality: - Bit 0: 0 = client-initiated, 1 = server-initiated - Bit 1: 0 = bidirectional, 1 = unidirectional Client-initiated bidirectional: 0, 4, 8, ... Server-initiated bidirectional: 1, 5, 9, ... Client-initiated unidirectional: 2, 6, 10, ... Server-initiated unidirectional: 3, 7, 11, ...","ref":"quic_stream.html"},{"type":"opaque","title":"quic_stream.stream/0","doc":"","ref":"quic_stream.html#t:stream/0"},{"type":"function","title":"quic_stream.ack_send/2","doc":"Acknowledge that sent data was received.","ref":"quic_stream.html#ack_send/2"},{"type":"function","title":"quic_stream.blocked/1","doc":"Check if the stream is blocked on flow control.","ref":"quic_stream.html#blocked/1"},{"type":"function","title":"quic_stream.bytes_available/1","doc":"Get number of bytes available for reading.","ref":"quic_stream.html#bytes_available/1"},{"type":"function","title":"quic_stream.bytes_to_send/1","doc":"Get number of bytes waiting to be sent.","ref":"quic_stream.html#bytes_to_send/1"},{"type":"function","title":"quic_stream.can_send/1","doc":"Check if we can send data on this stream.","ref":"quic_stream.html#can_send/1"},{"type":"function","title":"quic_stream.close/1","doc":"Close the stream gracefully.","ref":"quic_stream.html#close/1"},{"type":"function","title":"quic_stream.direction/1","doc":"Get the direction of the stream.","ref":"quic_stream.html#direction/1"},{"type":"function","title":"quic_stream.get_send_data/2","doc":"Get data to send, up to MaxBytes. Returns {Data, Offset, Fin, UpdatedStream}","ref":"quic_stream.html#get_send_data/2"},{"type":"function","title":"quic_stream.id/1","doc":"Get the stream ID.","ref":"quic_stream.html#id/1"},{"type":"function","title":"quic_stream.initiator/1","doc":"Get the initiator of the stream.","ref":"quic_stream.html#initiator/1"},{"type":"function","title":"quic_stream.is_bidi/1","doc":"Check if this is a bidirectional stream.","ref":"quic_stream.html#is_bidi/1"},{"type":"function","title":"quic_stream.is_closed/1","doc":"Check if the stream is fully closed.","ref":"quic_stream.html#is_closed/1"},{"type":"function","title":"quic_stream.is_local/2","doc":"Check if this stream was initiated by us.","ref":"quic_stream.html#is_local/2"},{"type":"function","title":"quic_stream.is_recv_closed/1","doc":"Check if the receive side is closed.","ref":"quic_stream.html#is_recv_closed/1"},{"type":"function","title":"quic_stream.is_send_closed/1","doc":"Check if the send side is closed.","ref":"quic_stream.html#is_send_closed/1"},{"type":"function","title":"quic_stream.new/2","doc":"Create a new stream with default flow control limits.","ref":"quic_stream.html#new/2"},{"type":"function","title":"quic_stream.new/3","doc":"Create a new stream with custom options.","ref":"quic_stream.html#new/3"},{"type":"function","title":"quic_stream.read/1","doc":"Read all available contiguous data.","ref":"quic_stream.html#read/1"},{"type":"function","title":"quic_stream.read/2","doc":"Read up to MaxBytes of contiguous data.","ref":"quic_stream.html#read/2"},{"type":"function","title":"quic_stream.receive_data/4","doc":"Receive data at a specific offset.","ref":"quic_stream.html#receive_data/4"},{"type":"function","title":"quic_stream.receive_fin/2","doc":"Mark that FIN was received at the given offset.","ref":"quic_stream.html#receive_fin/2"},{"type":"function","title":"quic_stream.reset/2","doc":"Reset the stream (send RESET_STREAM).","ref":"quic_stream.html#reset/2"},{"type":"function","title":"quic_stream.send/2","doc":"Queue data for sending on the stream.","ref":"quic_stream.html#send/2"},{"type":"function","title":"quic_stream.send_fin/1","doc":"Mark the stream as finished for sending (FIN).","ref":"quic_stream.html#send_fin/1"},{"type":"function","title":"quic_stream.state/1","doc":"Get the current stream state.","ref":"quic_stream.html#state/1"},{"type":"function","title":"quic_stream.stop_sending/2","doc":"Handle STOP_SENDING frame from peer.","ref":"quic_stream.html#stop_sending/2"},{"type":"function","title":"quic_stream.update_max_data/2","doc":"Update the maximum data we can receive.","ref":"quic_stream.html#update_max_data/2"},{"type":"function","title":"quic_stream.update_send_window/2","doc":"Update the send window (peer's MAX_STREAM_DATA).","ref":"quic_stream.html#update_send_window/2"},{"type":"module","title":"quic_frame","doc":"QUIC frame encoding and decoding. This module handles encoding and decoding of all 21 QUIC frame types as defined in RFC 9000 Section 12.4.","ref":"quic_frame.html"},{"type":"type","title":"quic_frame.ecn_counts/0","doc":"","ref":"quic_frame.html#t:ecn_counts/0"},{"type":"type","title":"quic_frame.frame/0","doc":"","ref":"quic_frame.html#t:frame/0"},{"type":"function","title":"quic_frame.decode/1","doc":"Decode a single frame from binary. Returns {Frame, Rest} or {error, Reason}.","ref":"quic_frame.html#decode/1"},{"type":"function","title":"quic_frame.decode_all/1","doc":"Decode all frames from a packet payload. Returns a list of frames.","ref":"quic_frame.html#decode_all/1"},{"type":"function","title":"quic_frame.encode/1","doc":"Encode a frame to binary.","ref":"quic_frame.html#encode/1"},{"type":"module","title":"quic_packet","doc":"QUIC packet encoding and decoding. This module handles encoding and decoding of QUIC packets including: - Long header packets (Initial, Handshake, 0-RTT, Retry) - Short header packets (1-RTT) Packet Header Format Long Header: <span class=\"w\">   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"mi\">1</span><span class=\"p\">|</span><span class=\"mi\">1</span><span class=\"p\">|</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"p\">|</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"p\">|</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"w\">                         </span><span class=\"n\">Version</span><span class=\"w\"> </span><span class=\"p\" data-group-id=\"2799330851-1\">(</span><span class=\"mi\">32</span><span class=\"p\" data-group-id=\"2799330851-1\">)</span><span class=\"w\">                          </span><span class=\"p\">|</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"w\"> </span><span class=\"n\">DCID</span><span class=\"w\"> </span><span class=\"n\">Len</span><span class=\"w\"> </span><span class=\"p\" data-group-id=\"2799330851-2\">(</span><span class=\"mi\">8</span><span class=\"p\" data-group-id=\"2799330851-2\">)</span><span class=\"w\">  </span><span class=\"p\">|</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"w\">               </span><span class=\"n\">Destination</span><span class=\"w\"> </span><span class=\"n\">Connection</span><span class=\"w\"> </span><span class=\"n\">ID</span><span class=\"w\"> </span><span class=\"p\" data-group-id=\"2799330851-3\">(</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"mi\">160</span><span class=\"p\" data-group-id=\"2799330851-3\">)</span><span class=\"w\">            </span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"w\"> </span><span class=\"n\">SCID</span><span class=\"w\"> </span><span class=\"n\">Len</span><span class=\"w\"> </span><span class=\"p\" data-group-id=\"2799330851-4\">(</span><span class=\"mi\">8</span><span class=\"p\" data-group-id=\"2799330851-4\">)</span><span class=\"w\">  </span><span class=\"p\">|</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"w\">                 </span><span class=\"n\">Source</span><span class=\"w\"> </span><span class=\"n\">Connection</span><span class=\"w\"> </span><span class=\"n\">ID</span><span class=\"w\"> </span><span class=\"p\" data-group-id=\"2799330851-5\">(</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"mi\">160</span><span class=\"p\" data-group-id=\"2799330851-5\">)</span><span class=\"w\">               </span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span> Short Header: <span class=\"w\">   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"mi\">0</span><span class=\"p\">|</span><span class=\"mi\">1</span><span class=\"p\">|</span><span class=\"n\">S</span><span class=\"p\">|</span><span class=\"n\">R</span><span class=\"p\">|</span><span class=\"n\">R</span><span class=\"p\">|</span><span class=\"n\">K</span><span class=\"p\">|</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"p\">|</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"w\">\n   </span><span class=\"p\">|</span><span class=\"w\">                </span><span class=\"n\">Destination</span><span class=\"w\"> </span><span class=\"n\">Connection</span><span class=\"w\"> </span><span class=\"n\">ID</span><span class=\"w\"> </span><span class=\"p\" data-group-id=\"9768400805-1\">(</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"mi\">160</span><span class=\"p\" data-group-id=\"9768400805-1\">)</span><span class=\"w\">           </span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"p\">.</span><span class=\"w\">\n   </span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span><span class=\"o\">-</span><span class=\"o\">+</span>","ref":"quic_packet.html"},{"type":"type","title":"quic_packet.packet/0","doc":"","ref":"quic_packet.html#t:packet/0"},{"type":"type","title":"quic_packet.packet_type/0","doc":"","ref":"quic_packet.html#t:packet_type/0"},{"type":"function","title":"quic_packet.decode/2","doc":"Decode a QUIC packet. DCIDLen is used for short header packets where DCID length is implicit. Returns {ok, Packet, Rest} or {error, Reason}.","ref":"quic_packet.html#decode/2"},{"type":"function","title":"quic_packet.decode_pn/2","doc":"Decode a packet number.","ref":"quic_packet.html#decode_pn/2"},{"type":"function","title":"quic_packet.decode_short_key_phase/1","doc":"Extract the key phase bit from a short header first byte. The key phase bit is bit 2 of the first byte (after header protection removal). Returns 0 or 1.","ref":"quic_packet.html#decode_short_key_phase/1"},{"type":"function","title":"quic_packet.encode_long/5","doc":"Encode a long header packet. Type is one of: initial, handshake, zero_rtt, retry Returns the encoded packet header + payload. Note: For Initial packets, Token is required. Note: Packet number and payload should already be encrypted.","ref":"quic_packet.html#encode_long/5"},{"type":"function","title":"quic_packet.encode_pn/2","doc":"Encode a packet number.","ref":"quic_packet.html#encode_pn/2"},{"type":"function","title":"quic_packet.encode_short/4","doc":"Encode a short header (1-RTT) packet with default key phase 0. DCIDLen is the expected DCID length (from connection state). Returns the encoded packet.","ref":"quic_packet.html#encode_short/4"},{"type":"function","title":"quic_packet.encode_short/5","doc":"Encode a short header (1-RTT) packet with explicit key phase. KeyPhase is 0 or 1, indicating which set of keys was used for encryption. Returns the encoded packet.","ref":"quic_packet.html#encode_short/5"},{"type":"function","title":"quic_packet.pn_length/1","doc":"Calculate the minimum number of bytes needed for a packet number.","ref":"quic_packet.html#pn_length/1"},{"type":"module","title":"quic_varint","doc":"Variable-length integer encoding/decoding for QUIC. QUIC uses a variable-length integer encoding scheme where the two most significant bits of the first byte indicate the length: 2#00xxxxxx  - 1 byte, 6-bit value (0-63) 2#01xxxxxx  - 2 bytes, 14-bit value (0-16383) 2#10xxxxxx  - 4 bytes, 30-bit value (0-1073741823) 2#11xxxxxx  - 8 bytes, 62-bit value (0-4611686018427387903)","ref":"quic_varint.html"},{"type":"function","title":"quic_varint.decode/1","doc":"Decode a QUIC variable-length integer from a binary. Returns {Value, Rest} where Rest is the remaining binary. Raises error:badarg for invalid input.","ref":"quic_varint.html#decode/1"},{"type":"function","title":"quic_varint.encode/1","doc":"Encode an integer as a QUIC variable-length integer. Returns the encoded binary. Raises error:badarg for negative values or values > 2^62-1.","ref":"quic_varint.html#encode/1"},{"type":"function","title":"quic_varint.encode_len/1","doc":"Return the number of bytes needed to encode a value.","ref":"quic_varint.html#encode_len/1"},{"type":"function","title":"quic_varint.max_value/1","doc":"Return the maximum value that can be encoded in N bytes.","ref":"quic_varint.html#max_value/1"},{"type":"module","title":"quic_aead","doc":"AEAD encryption/decryption for QUIC packet protection. QUIC uses AEAD algorithms (AES-GCM, ChaCha20-Poly1305) to protect packet payloads. Header protection is applied to hide the packet number and certain header flags. Packet Protection The nonce for AEAD is computed by XORing the IV with the packet number (left-padded to 12 bytes). Header Protection A sample from the encrypted payload is used to generate a mask that protects the first header byte and packet number bytes.","ref":"quic_aead.html"},{"type":"type","title":"quic_aead.cipher/0","doc":"","ref":"quic_aead.html#t:cipher/0"},{"type":"function","title":"quic_aead.compute_nonce/2","doc":"Compute the nonce for AEAD by XORing IV with packet number. Packet number is left-padded to 12 bytes.","ref":"quic_aead.html#compute_nonce/2"},{"type":"function","title":"quic_aead.decrypt/5","doc":"Decrypt a QUIC packet payload using AEAD. Returns: {ok, Plaintext} | {error, bad_tag}","ref":"quic_aead.html#decrypt/5"},{"type":"function","title":"quic_aead.encrypt/5","doc":"Encrypt a QUIC packet payload using AEAD. Key: AEAD key IV: AEAD initialization vector PN: Packet number (used with IV to create nonce) AAD: Additional authenticated data (unprotected header) Plaintext: Payload to encrypt Returns: Ciphertext with authentication tag appended","ref":"quic_aead.html#encrypt/5"},{"type":"function","title":"quic_aead.protect_header/4","doc":"Apply header protection to a QUIC packet. HP: Header protection key Header: The packet header (first byte + rest + PN) EncryptedPayload: The AEAD-encrypted payload (ciphertext + tag) PNOffset: Offset of packet number in the header The sample is taken starting 4 bytes after the start of the Packet Number. Since PN is at the end of Header, and ciphertext comes after PN: sample_offset = 4 - PNLen (where PNLen is encoded in the first byte) Returns: Protected header (first byte and PN bytes masked), or {error, payload_too_short} if payload is too small for sampling.","ref":"quic_aead.html#protect_header/4"},{"type":"function","title":"quic_aead.unprotect_header/4","doc":"Remove header protection from a QUIC packet. HP: Header protection key ProtectedHeader: The protected header bytes (up to but not including PN) EncryptedPayload: PN bytes + ciphertext + tag PNOffset: Offset of packet number in the full header (= byte_size(ProtectedHeader)) The sample is taken at position 4 from the start of PN. Since EncryptedPayload starts with PN, sample is at position 4. Returns: {UnprotectedHeader, PNLength} or {error, payload_too_short}","ref":"quic_aead.html#unprotect_header/4"},{"type":"module","title":"quic_crypto","doc":"TLS 1.3 key schedule and cryptographic operations for QUIC. This module implements the TLS 1.3 key schedule used by QUIC for deriving encryption keys at each handshake stage. Key Schedule TLS 1.3 uses a three-stage key schedule: 1. Early Secret (from PSK, or zeros for non-PSK) 2. Handshake Secret (from ECDHE shared secret) 3. Master Secret (for application data) Traffic Secrets From each secret, traffic secrets are derived for both client and server directions.","ref":"quic_crypto.html"},{"type":"function","title":"quic_crypto.cipher_to_hash/1","doc":"Map cipher suite to corresponding hash algorithm.","ref":"quic_crypto.html#cipher_to_hash/1"},{"type":"function","title":"quic_crypto.compute_finished_verify/2","doc":"Compute the Finished verify_data. verify_data = HMAC(finished_key, Transcript-Hash(Handshake Context))","ref":"quic_crypto.html#compute_finished_verify/2"},{"type":"function","title":"quic_crypto.compute_finished_verify/3","doc":"Compute the Finished verify_data with cipher-specific hash.","ref":"quic_crypto.html#compute_finished_verify/3"},{"type":"function","title":"quic_crypto.compute_psk_binder/3","doc":"Compute PSK binder value for a pre_shared_key extension. RFC 8446 Section 4.2.11.2: binder_key = Derive-Secret(early_secret, \"res binder\" | \"ext binder\", \"\") binder = HMAC(binder_key, Transcript-Hash(Truncated ClientHello)) For resumption PSK, use \"res binder\". For external PSK, use \"ext binder\".","ref":"quic_crypto.html#compute_psk_binder/3"},{"type":"function","title":"quic_crypto.compute_psk_binder/4","doc":"Compute PSK binder with cipher-specific hash.","ref":"quic_crypto.html#compute_psk_binder/4"},{"type":"function","title":"quic_crypto.compute_retry_integrity_tag/3","doc":"Compute the integrity tag for a Retry packet. Used by servers to generate tags and by clients to verify.","ref":"quic_crypto.html#compute_retry_integrity_tag/3"},{"type":"function","title":"quic_crypto.compute_shared_secret/3","doc":"Compute ECDHE shared secret. shared_secret = ECDH(our_private, their_public)","ref":"quic_crypto.html#compute_shared_secret/3"},{"type":"function","title":"quic_crypto.derive_client_app_secret/2","doc":"Derive client application traffic secret. client_application_traffic_secret_0 = Derive-Secret( master_secret, \"c ap traffic\", ClientHello...server Finished)","ref":"quic_crypto.html#derive_client_app_secret/2"},{"type":"function","title":"quic_crypto.derive_client_app_secret/3","doc":"Derive client application traffic secret with cipher-specific hash.","ref":"quic_crypto.html#derive_client_app_secret/3"},{"type":"function","title":"quic_crypto.derive_client_early_traffic_secret/2","doc":"Derive client early traffic secret. client_early_traffic_secret = Derive-Secret(early_secret, \"c e traffic\", ClientHello) This is used to encrypt 0-RTT data before the handshake completes.","ref":"quic_crypto.html#derive_client_early_traffic_secret/2"},{"type":"function","title":"quic_crypto.derive_client_early_traffic_secret/3","doc":"Derive client early traffic secret with cipher-specific hash.","ref":"quic_crypto.html#derive_client_early_traffic_secret/3"},{"type":"function","title":"quic_crypto.derive_client_handshake_secret/2","doc":"Derive client handshake traffic secret. client_handshake_traffic_secret = Derive-Secret( handshake_secret, \"c hs traffic\", ClientHello...ServerHello)","ref":"quic_crypto.html#derive_client_handshake_secret/2"},{"type":"function","title":"quic_crypto.derive_client_handshake_secret/3","doc":"Derive client handshake traffic secret with cipher-specific hash.","ref":"quic_crypto.html#derive_client_handshake_secret/3"},{"type":"function","title":"quic_crypto.derive_early_exporter_master_secret/2","doc":"Derive early exporter master secret. early_exporter_master_secret = Derive-Secret(early_secret, \"e exp master\", ClientHello)","ref":"quic_crypto.html#derive_early_exporter_master_secret/2"},{"type":"function","title":"quic_crypto.derive_early_secret/0","doc":"Derive early secret without PSK (zeros). early_secret = HKDF-Extract(0, 0)","ref":"quic_crypto.html#derive_early_secret/0"},{"type":"function","title":"quic_crypto.derive_early_secret/1","doc":"Derive early secret with PSK. early_secret = HKDF-Extract(0, PSK)","ref":"quic_crypto.html#derive_early_secret/1"},{"type":"function","title":"quic_crypto.derive_early_secret/2","doc":"Derive early secret with cipher-specific hash.","ref":"quic_crypto.html#derive_early_secret/2"},{"type":"function","title":"quic_crypto.derive_finished_key/1","doc":"Derive the finished key from a traffic secret. finished_key = HKDF-Expand-Label(BaseKey, \"finished\", \"\", Hash.length)","ref":"quic_crypto.html#derive_finished_key/1"},{"type":"function","title":"quic_crypto.derive_finished_key/2","doc":"Derive the finished key with cipher-specific hash.","ref":"quic_crypto.html#derive_finished_key/2"},{"type":"function","title":"quic_crypto.derive_handshake_secret/2","doc":"Derive handshake secret from early secret and ECDHE shared secret. handshake_secret = HKDF-Extract( Derive-Secret(early_secret, \"derived\", \"\"), shared_secret)","ref":"quic_crypto.html#derive_handshake_secret/2"},{"type":"function","title":"quic_crypto.derive_handshake_secret/3","doc":"Derive handshake secret with cipher-specific hash.","ref":"quic_crypto.html#derive_handshake_secret/3"},{"type":"function","title":"quic_crypto.derive_master_secret/1","doc":"Derive master secret from handshake secret. master_secret = HKDF-Extract( Derive-Secret(handshake_secret, \"derived\", \"\"), 0)","ref":"quic_crypto.html#derive_master_secret/1"},{"type":"function","title":"quic_crypto.derive_master_secret/2","doc":"Derive master secret with cipher-specific hash.","ref":"quic_crypto.html#derive_master_secret/2"},{"type":"function","title":"quic_crypto.derive_secret/3","doc":"Derive-Secret with raw messages (will be hashed). Derive-Secret(Secret, Label, Messages) = HKDF-Expand-Label(Secret, Label, Transcript-Hash(Messages), Hash.length)","ref":"quic_crypto.html#derive_secret/3"},{"type":"function","title":"quic_crypto.derive_secret/4","doc":"Derive-Secret with specified hash algorithm.","ref":"quic_crypto.html#derive_secret/4"},{"type":"function","title":"quic_crypto.derive_server_app_secret/2","doc":"Derive server application traffic secret. server_application_traffic_secret_0 = Derive-Secret( master_secret, \"s ap traffic\", ClientHello...server Finished)","ref":"quic_crypto.html#derive_server_app_secret/2"},{"type":"function","title":"quic_crypto.derive_server_app_secret/3","doc":"Derive server application traffic secret with cipher-specific hash.","ref":"quic_crypto.html#derive_server_app_secret/3"},{"type":"function","title":"quic_crypto.derive_server_handshake_secret/2","doc":"Derive server handshake traffic secret. server_handshake_traffic_secret = Derive-Secret( handshake_secret, \"s hs traffic\", ClientHello...ServerHello)","ref":"quic_crypto.html#derive_server_handshake_secret/2"},{"type":"function","title":"quic_crypto.derive_server_handshake_secret/3","doc":"Derive server handshake traffic secret with cipher-specific hash.","ref":"quic_crypto.html#derive_server_handshake_secret/3"},{"type":"function","title":"quic_crypto.generate_key_pair/1","doc":"Generate an ECDHE key pair for the specified curve. Returns {PublicKey, PrivateKey}","ref":"quic_crypto.html#generate_key_pair/1"},{"type":"function","title":"quic_crypto.hash_len/1","doc":"","ref":"quic_crypto.html#hash_len/1"},{"type":"function","title":"quic_crypto.transcript_hash/1","doc":"Compute transcript hash of handshake messages (default SHA-256).","ref":"quic_crypto.html#transcript_hash/1"},{"type":"function","title":"quic_crypto.transcript_hash/2","doc":"Compute transcript hash with specified hash algorithm or cipher. Accepts both hash atoms (sha256, sha384) and cipher atoms (aes_128_gcm, aes_256_gcm).","ref":"quic_crypto.html#transcript_hash/2"},{"type":"function","title":"quic_crypto.verify_retry_integrity_tag/3","doc":"Verify the integrity tag of a Retry packet. RFC 9001 Section 5.8: - Retry Pseudo-Packet = <ODCID length> <ODCID> <Retry packet without tag> - Tag = AES-128-GCM(Key, Nonce, AAD=Pseudo-Packet, \"\") Returns true if the tag is valid, false otherwise.","ref":"quic_crypto.html#verify_retry_integrity_tag/3"},{"type":"module","title":"quic_hkdf","doc":"HKDF implementation for QUIC key derivation. HKDF is used in QUIC/TLS 1.3 for deriving keys from shared secrets. This module implements the Extract-Expand paradigm with SHA-256.","ref":"quic_hkdf.html"},{"type":"function","title":"quic_hkdf.expand/3","doc":"HKDF-Expand using SHA-256. Expands a pseudorandom key to the desired length.","ref":"quic_hkdf.html#expand/3"},{"type":"function","title":"quic_hkdf.expand/4","doc":"HKDF-Expand with specified hash algorithm.","ref":"quic_hkdf.html#expand/4"},{"type":"function","title":"quic_hkdf.expand_label/4","doc":"HKDF-Expand-Label for TLS 1.3/QUIC. Label format: \"tls13 \" ++ Label Context is the additional info (often empty for QUIC).","ref":"quic_hkdf.html#expand_label/4"},{"type":"function","title":"quic_hkdf.expand_label/5","doc":"HKDF-Expand-Label with specified hash algorithm. Implements TLS 1.3 HKDF-Expand-Label (RFC 8446 Section 7.1)","ref":"quic_hkdf.html#expand_label/5"},{"type":"function","title":"quic_hkdf.extract/2","doc":"HKDF-Extract using SHA-256. Extracts a pseudorandom key from input keying material. Salt defaults to a string of HashLen zeros if not provided.","ref":"quic_hkdf.html#extract/2"},{"type":"function","title":"quic_hkdf.extract/3","doc":"HKDF-Extract with specified hash algorithm.","ref":"quic_hkdf.html#extract/3"},{"type":"module","title":"quic_keys","doc":"QUIC key derivation for packet protection. This module derives the cryptographic keys used for QUIC packet protection at each encryption level (Initial, Handshake, Application). Initial Keys Initial keys are derived from the Destination Connection ID using a fixed salt defined in RFC 9001. Key Derivation Keys are derived using HKDF-Expand-Label with the following labels: - \"quic key\" for the AEAD key - \"quic iv\" for the AEAD IV/nonce - \"quic hp\" for header protection key","ref":"quic_keys.html"},{"type":"type","title":"quic_keys.keys/0","doc":"","ref":"quic_keys.html#t:keys/0"},{"type":"function","title":"quic_keys.derive_initial_client/1","doc":"Derive initial client keys from DCID. Returns {Key, IV, HP} for client Initial packets.","ref":"quic_keys.html#derive_initial_client/1"},{"type":"function","title":"quic_keys.derive_initial_client/2","doc":"Derive initial client keys from DCID with version.","ref":"quic_keys.html#derive_initial_client/2"},{"type":"function","title":"quic_keys.derive_initial_secret/1","doc":"Derive the initial secret from DCID using QUIC v1 salt.","ref":"quic_keys.html#derive_initial_secret/1"},{"type":"function","title":"quic_keys.derive_initial_secret/2","doc":"Derive the initial secret from DCID. Version determines which salt to use.","ref":"quic_keys.html#derive_initial_secret/2"},{"type":"function","title":"quic_keys.derive_initial_server/1","doc":"Derive initial server keys from DCID. Returns {Key, IV, HP} for server Initial packets.","ref":"quic_keys.html#derive_initial_server/1"},{"type":"function","title":"quic_keys.derive_initial_server/2","doc":"Derive initial server keys from DCID with version.","ref":"quic_keys.html#derive_initial_server/2"},{"type":"function","title":"quic_keys.derive_keys/2","doc":"Derive keys from a traffic secret. Returns {Key, IV, HP} for the given secret.","ref":"quic_keys.html#derive_keys/2"},{"type":"function","title":"quic_keys.derive_traffic_keys/1","doc":"Derive traffic keys (Key, IV, HP) from a traffic secret. Uses AES-128-GCM key sizes (16-byte key, 12-byte IV, 16-byte HP). This is used for Initial and Handshake encryption levels.","ref":"quic_keys.html#derive_traffic_keys/1"},{"type":"function","title":"quic_keys.derive_updated_keys/2","doc":"Derive updated keys from an updated application secret. This performs the full key update: derives the new secret and then derives keys. Returns {UpdatedSecret, {Key, IV, HP}}.","ref":"quic_keys.html#derive_updated_keys/2"},{"type":"function","title":"quic_keys.derive_updated_secret/2","doc":"Derive an updated application secret for key update (RFC 9001 Section 6). The next application secret is computed as: updated_secret = HKDF-Expand-Label(current_secret, \"quic ku\", \"\", hash_len) where \"quic ku\" is the label for key update.","ref":"quic_keys.html#derive_updated_secret/2"},{"type":"module","title":"quic_tls","doc":"TLS 1.3 message generation and parsing for QUIC. This module handles TLS 1.3 handshake messages as they appear in QUIC CRYPTO frames. Messages are encoded without the TLS record layer. TLS Messages in QUIC QUIC uses TLS 1.3 for the cryptographic handshake, but without the TLS record layer. TLS handshake messages are sent directly in CRYPTO frames.","ref":"quic_tls.html"},{"type":"function","title":"quic_tls.build_certificate/2","doc":"Build Certificate message. Certs is a list of DER-encoded certificates (server cert first).","ref":"quic_tls.html#build_certificate/2"},{"type":"function","title":"quic_tls.build_certificate_verify/3","doc":"Build CertificateVerify message. PrivateKey is the server's private key. TranscriptHash is the hash of all handshake messages up to (not including) CertificateVerify.","ref":"quic_tls.html#build_certificate_verify/3"},{"type":"function","title":"quic_tls.build_client_hello/1","doc":"Build a TLS 1.3 ClientHello message for QUIC. Options: - server_name: SNI hostname (binary) - alpn: List of ALPN protocols (list of binaries) - transport_params: QUIC transport parameters (map) Returns: {ClientHelloMsg, PrivateKey, Random}","ref":"quic_tls.html#build_client_hello/1"},{"type":"function","title":"quic_tls.build_encrypted_extensions/1","doc":"Build EncryptedExtensions message. Options: - alpn: Selected ALPN protocol - transport_params: QUIC transport parameters","ref":"quic_tls.html#build_encrypted_extensions/1"},{"type":"function","title":"quic_tls.build_finished/1","doc":"Build a Finished message. VerifyData should be computed using quic_crypto:compute_finished_verify/2.","ref":"quic_tls.html#build_finished/1"},{"type":"function","title":"quic_tls.build_server_hello/1","doc":"Build a ServerHello message. Options: - random: Server random (32 bytes, generated if not provided) - session_id: Legacy session ID to echo - cipher_suite: Selected cipher suite - key_share: Server's public key","ref":"quic_tls.html#build_server_hello/1"},{"type":"function","title":"quic_tls.decode_handshake_message/1","doc":"Decode a TLS handshake message. Returns {Type, Body, Rest} or {error, Reason}.","ref":"quic_tls.html#decode_handshake_message/1"},{"type":"function","title":"quic_tls.decode_transport_params/1","doc":"Decode QUIC transport parameters.","ref":"quic_tls.html#decode_transport_params/1"},{"type":"function","title":"quic_tls.encode_handshake_message/2","doc":"Encode a TLS handshake message with type and length.","ref":"quic_tls.html#encode_handshake_message/2"},{"type":"function","title":"quic_tls.encode_transport_params/1","doc":"Encode QUIC transport parameters. Params is a map with keys like: original_dcid, max_idle_timeout, max_udp_payload_size, initial_max_data, initial_max_stream_data_bidi_local, etc.","ref":"quic_tls.html#encode_transport_params/1"},{"type":"function","title":"quic_tls.parse_certificate/1","doc":"Parse Certificate message.","ref":"quic_tls.html#parse_certificate/1"},{"type":"function","title":"quic_tls.parse_certificate_verify/1","doc":"Parse CertificateVerify message.","ref":"quic_tls.html#parse_certificate_verify/1"},{"type":"function","title":"quic_tls.parse_client_hello/1","doc":"Parse a ClientHello message. Returns a map with: - random: 32-byte client random - session_id: Legacy session ID - cipher_suites: List of cipher suites offered - extensions: Map of extensions - key_share: Client's public key for key exchange - server_name: SNI hostname (if present) - alpn_protocols: List of ALPN protocols (if present) - transport_params: QUIC transport parameters (if present)","ref":"quic_tls.html#parse_client_hello/1"},{"type":"function","title":"quic_tls.parse_encrypted_extensions/1","doc":"Parse EncryptedExtensions message.","ref":"quic_tls.html#parse_encrypted_extensions/1"},{"type":"function","title":"quic_tls.parse_finished/1","doc":"Parse Finished message.","ref":"quic_tls.html#parse_finished/1"},{"type":"function","title":"quic_tls.parse_server_hello/1","doc":"Parse a ServerHello message. Returns server's public key and selected cipher suite.","ref":"quic_tls.html#parse_server_hello/1"},{"type":"function","title":"quic_tls.verify_finished/3","doc":"Verify a Finished message (default SHA-256). TrafficSecret is the sender's traffic secret. TranscriptHash is the hash of all messages up to (but not including) Finished.","ref":"quic_tls.html#verify_finished/3"},{"type":"function","title":"quic_tls.verify_finished/4","doc":"Verify a Finished message with cipher-specific hash.","ref":"quic_tls.html#verify_finished/4"},{"type":"module","title":"quic_ack","doc":"QUIC ACK frame generation and processing. This module handles: - Tracking received packet numbers - Generating ACK frames with ranges - Processing incoming ACK frames - ACK delay calculation ACK Ranges ACK ranges are stored as a list of {Start, End} tuples where Start =< End. The list is sorted in descending order by Start. Example: [{100, 105}, {90, 95}, {80, 82}] acknowledges packets 100-105, 90-95, and 80-82.","ref":"quic_ack.html"},{"type":"opaque","title":"quic_ack.ack_state/0","doc":"","ref":"quic_ack.html#t:ack_state/0"},{"type":"function","title":"quic_ack.ack_eliciting_in_flight/1","doc":"Get the number of ACK-eliciting packets in flight.","ref":"quic_ack.html#ack_eliciting_in_flight/1"},{"type":"function","title":"quic_ack.ack_ranges/1","doc":"Get the current ACK ranges.","ref":"quic_ack.html#ack_ranges/1"},{"type":"function","title":"quic_ack.generate_ack/1","doc":"Generate an ACK frame for the current state. Returns {ok, AckFrame} or {error, no_packets}.","ref":"quic_ack.html#generate_ack/1"},{"type":"function","title":"quic_ack.generate_ack/2","doc":"Generate an ACK frame with a specific timestamp.","ref":"quic_ack.html#generate_ack/2"},{"type":"function","title":"quic_ack.largest_acked/1","doc":"Get the largest acknowledged packet number.","ref":"quic_ack.html#largest_acked/1"},{"type":"function","title":"quic_ack.largest_received/1","doc":"Get the largest received packet number.","ref":"quic_ack.html#largest_received/1"},{"type":"function","title":"quic_ack.mark_ack_sent/1","doc":"Mark that an ACK was sent.","ref":"quic_ack.html#mark_ack_sent/1"},{"type":"function","title":"quic_ack.needs_ack/1","doc":"Check if an ACK needs to be sent.","ref":"quic_ack.html#needs_ack/1"},{"type":"function","title":"quic_ack.new/0","doc":"Create a new ACK tracking state.","ref":"quic_ack.html#new/0"},{"type":"function","title":"quic_ack.process_ack/2","doc":"Process a received ACK frame. Returns {NewState, AckedPackets} where AckedPackets is a list of newly acknowledged packet numbers.","ref":"quic_ack.html#process_ack/2"},{"type":"function","title":"quic_ack.process_ack/3","doc":"Process a received ACK frame with sent packet info. SentPackets is a map of PacketNumber => SentPacketInfo","ref":"quic_ack.html#process_ack/3"},{"type":"function","title":"quic_ack.record_received/2","doc":"Record that a packet was received.","ref":"quic_ack.html#record_received/2"},{"type":"function","title":"quic_ack.record_received/3","doc":"Record that a packet was received, optionally marking it as ACK-eliciting.","ref":"quic_ack.html#record_received/3"},{"type":"module","title":"quic_cc","doc":"QUIC NewReno congestion control implementation. This module implements the NewReno congestion control algorithm: - Slow Start: Exponential growth until threshold or loss - Congestion Avoidance: Linear growth after threshold - Recovery: Multiplicative decrease on loss - Persistent Congestion: Reset on prolonged loss Phases 1. Slow Start: cwnd += bytes_acked (exponential growth) 2. Congestion Avoidance: cwnd += max_datagram_size * bytes_acked / cwnd 3. Recovery: ssthresh = cwnd * 0.5, cwnd = max(ssthresh, min_window)","ref":"quic_cc.html"},{"type":"opaque","title":"quic_cc.cc_state/0","doc":"","ref":"quic_cc.html#t:cc_state/0"},{"type":"function","title":"quic_cc.available_cwnd/1","doc":"Get the available congestion window (cwnd - bytes_in_flight).","ref":"quic_cc.html#available_cwnd/1"},{"type":"function","title":"quic_cc.bytes_in_flight/1","doc":"Get bytes currently in flight.","ref":"quic_cc.html#bytes_in_flight/1"},{"type":"function","title":"quic_cc.can_send/2","doc":"Check if we can send more bytes.","ref":"quic_cc.html#can_send/2"},{"type":"function","title":"quic_cc.cwnd/1","doc":"Get the current congestion window.","ref":"quic_cc.html#cwnd/1"},{"type":"function","title":"quic_cc.ecn_ce_counter/1","doc":"Get the current ECN-CE counter.","ref":"quic_cc.html#ecn_ce_counter/1"},{"type":"function","title":"quic_cc.in_recovery/1","doc":"Check if in recovery phase.","ref":"quic_cc.html#in_recovery/1"},{"type":"function","title":"quic_cc.in_slow_start/1","doc":"Check if in slow start phase.","ref":"quic_cc.html#in_slow_start/1"},{"type":"function","title":"quic_cc.new/0","doc":"Create a new congestion control state.","ref":"quic_cc.html#new/0"},{"type":"function","title":"quic_cc.new/1","doc":"Create a new congestion control state with options.","ref":"quic_cc.html#new/1"},{"type":"function","title":"quic_cc.on_congestion_event/2","doc":"Handle a congestion event (packet loss detected). SentTime is the time when the lost packet was sent.","ref":"quic_cc.html#on_congestion_event/2"},{"type":"function","title":"quic_cc.on_ecn_ce/2","doc":"Handle ECN-CE (Congestion Experienced) signal from ACK. RFC 9002: An increase in ECN-CE count is treated as a congestion signal. NewCECount is the ECN-CE count from the received ACK frame. SentTime is the time when the largest acknowledged packet was sent.","ref":"quic_cc.html#on_ecn_ce/2"},{"type":"function","title":"quic_cc.on_packet_sent/2","doc":"Record that a packet was sent.","ref":"quic_cc.html#on_packet_sent/2"},{"type":"function","title":"quic_cc.on_packets_acked/2","doc":"Process acknowledged packets. AckedBytes is the total size of acknowledged packets.","ref":"quic_cc.html#on_packets_acked/2"},{"type":"function","title":"quic_cc.on_packets_lost/2","doc":"Process lost packets. LostBytes is the total size of lost packets.","ref":"quic_cc.html#on_packets_lost/2"},{"type":"function","title":"quic_cc.ssthresh/1","doc":"Get the slow start threshold.","ref":"quic_cc.html#ssthresh/1"},{"type":"module","title":"quic_flow","doc":"QUIC connection-level flow control implementation. This module manages flow control at the connection level: - Tracking bytes sent against peer's MAX_DATA limit - Tracking bytes received against our MAX_DATA limit - Generating MAX_DATA frames when needed - Detecting when we're blocked by flow control Flow Control Concepts - MAX_DATA: Maximum total bytes the peer can send - DATA_BLOCKED: Indicates sender is blocked by receiver's limit - Window: The difference between max_data and bytes received","ref":"quic_flow.html"},{"type":"opaque","title":"quic_flow.flow_state/0","doc":"","ref":"quic_flow.html#t:flow_state/0"},{"type":"function","title":"quic_flow.bytes_received/1","doc":"Get total bytes we've received.","ref":"quic_flow.html#bytes_received/1"},{"type":"function","title":"quic_flow.bytes_sent/1","doc":"Get total bytes we've sent.","ref":"quic_flow.html#bytes_sent/1"},{"type":"function","title":"quic_flow.can_send/2","doc":"Check if we can send the specified number of bytes.","ref":"quic_flow.html#can_send/2"},{"type":"function","title":"quic_flow.generate_max_data/1","doc":"Generate a new MAX_DATA value to send. Returns {NewMaxData, UpdatedState}.","ref":"quic_flow.html#generate_max_data/1"},{"type":"function","title":"quic_flow.new/0","doc":"Create a new flow control state.","ref":"quic_flow.html#new/0"},{"type":"function","title":"quic_flow.new/1","doc":"Create a new flow control state with options.","ref":"quic_flow.html#new/1"},{"type":"function","title":"quic_flow.on_data_received/2","doc":"Record that we received data.","ref":"quic_flow.html#on_data_received/2"},{"type":"function","title":"quic_flow.on_data_sent/2","doc":"Record that we sent data. Returns {ok, NewState} or {blocked, NewState} if we hit the limit.","ref":"quic_flow.html#on_data_sent/2"},{"type":"function","title":"quic_flow.on_max_data_received/2","doc":"Process a MAX_DATA frame from peer. Updates our send limit.","ref":"quic_flow.html#on_max_data_received/2"},{"type":"function","title":"quic_flow.recv_limit/1","doc":"Get our current receive limit (our MAX_DATA).","ref":"quic_flow.html#recv_limit/1"},{"type":"function","title":"quic_flow.recv_window/1","doc":"Get available receive window.","ref":"quic_flow.html#recv_window/1"},{"type":"function","title":"quic_flow.send_blocked/1","doc":"Check if we're currently blocked on send flow control.","ref":"quic_flow.html#send_blocked/1"},{"type":"function","title":"quic_flow.send_limit/1","doc":"Get our current send limit (peer's MAX_DATA).","ref":"quic_flow.html#send_limit/1"},{"type":"function","title":"quic_flow.send_window/1","doc":"Get available send window.","ref":"quic_flow.html#send_window/1"},{"type":"function","title":"quic_flow.should_send_max_data/1","doc":"Check if we should send a MAX_DATA update. Returns true if we've consumed more than the threshold.","ref":"quic_flow.html#should_send_max_data/1"},{"type":"module","title":"quic_loss","doc":"QUIC loss detection implementation. This module implements: - Packet loss detection using time and packet thresholds - RTT estimation (smoothed RTT, RTT variance) - Probe Timeout (PTO) calculation - Loss detection timer management Loss Detection Methods 1. Packet Threshold: A packet is lost if a packet sent more than kPacketThreshold (3) later has been acknowledged. 2. Time Threshold: A packet is lost if it was sent more than max(kTimeThreshold * smoothed_rtt, kGranularity) ago and a later packet has been acknowledged.","ref":"quic_loss.html"},{"type":"opaque","title":"quic_loss.loss_state/0","doc":"","ref":"quic_loss.html#t:loss_state/0"},{"type":"function","title":"quic_loss.bytes_in_flight/1","doc":"Get bytes currently in flight.","ref":"quic_loss.html#bytes_in_flight/1"},{"type":"function","title":"quic_loss.detect_lost_packets/2","doc":"Detect lost packets based on time and packet thresholds.","ref":"quic_loss.html#detect_lost_packets/2"},{"type":"function","title":"quic_loss.get_loss_time_and_space/1","doc":"Get the loss time for setting timers.","ref":"quic_loss.html#get_loss_time_and_space/1"},{"type":"function","title":"quic_loss.get_pto/1","doc":"Calculate the Probe Timeout. PTO = smoothed_rtt + max(4 * rttvar, kGranularity) + max_ack_delay","ref":"quic_loss.html#get_pto/1"},{"type":"function","title":"quic_loss.latest_rtt/1","doc":"Get the latest RTT sample.","ref":"quic_loss.html#latest_rtt/1"},{"type":"function","title":"quic_loss.min_rtt/1","doc":"Get the minimum RTT.","ref":"quic_loss.html#min_rtt/1"},{"type":"function","title":"quic_loss.new/0","doc":"Create a new loss detection state.","ref":"quic_loss.html#new/0"},{"type":"function","title":"quic_loss.new/1","doc":"Create a new loss detection state with options.","ref":"quic_loss.html#new/1"},{"type":"function","title":"quic_loss.on_ack_received/3","doc":"Process an ACK frame. Returns {NewState, AckedPackets, LostPackets}","ref":"quic_loss.html#on_ack_received/3"},{"type":"function","title":"quic_loss.on_packet_sent/4","doc":"Record that a packet was sent (without frames).","ref":"quic_loss.html#on_packet_sent/4"},{"type":"function","title":"quic_loss.on_packet_sent/5","doc":"Record that a packet was sent with frames.","ref":"quic_loss.html#on_packet_sent/5"},{"type":"function","title":"quic_loss.on_pto_expired/1","doc":"Handle PTO expiration.","ref":"quic_loss.html#on_pto_expired/1"},{"type":"function","title":"quic_loss.pto_count/1","doc":"Get current PTO count.","ref":"quic_loss.html#pto_count/1"},{"type":"function","title":"quic_loss.retransmittable_frames/1","doc":"Filter frames to get only retransmittable ones. Per RFC 9002, PADDING, ACK, and CONNECTION_CLOSE frames are not retransmitted.","ref":"quic_loss.html#retransmittable_frames/1"},{"type":"function","title":"quic_loss.rtt_var/1","doc":"Get the RTT variance.","ref":"quic_loss.html#rtt_var/1"},{"type":"function","title":"quic_loss.sent_packets/1","doc":"Get all sent packets.","ref":"quic_loss.html#sent_packets/1"},{"type":"function","title":"quic_loss.smoothed_rtt/1","doc":"Get the smoothed RTT.","ref":"quic_loss.html#smoothed_rtt/1"},{"type":"function","title":"quic_loss.update_rtt/3","doc":"Update RTT estimates with a new sample.","ref":"quic_loss.html#update_rtt/3"},{"type":"module","title":"quic_ticket","doc":"Session ticket storage and PSK derivation for 0-RTT. This module handles: - Storing and retrieving NewSessionTicket messages - Deriving PSK from resumption_master_secret - Managing ticket lifetimes and early data limits","ref":"quic_ticket.html"},{"type":"type","title":"quic_ticket.session_ticket/0","doc":"","ref":"quic_ticket.html#t:session_ticket/0"},{"type":"type","title":"quic_ticket.ticket_store/0","doc":"","ref":"quic_ticket.html#t:ticket_store/0"},{"type":"function","title":"quic_ticket.clear_expired/1","doc":"Remove all expired tickets from the store.","ref":"quic_ticket.html#clear_expired/1"},{"type":"function","title":"quic_ticket.clear_ticket/2","doc":"Remove a ticket for a server.","ref":"quic_ticket.html#clear_ticket/2"},{"type":"function","title":"quic_ticket.derive_psk/2","doc":"Derive PSK from resumption_master_secret and ticket nonce. RFC 8446 Section 4.6.1: PSK = HKDF-Expand-Label(resumption_master_secret, \"resumption\", ticket_nonce, Hash.length)","ref":"quic_ticket.html#derive_psk/2"},{"type":"function","title":"quic_ticket.derive_resumption_secret/4","doc":"Derive the resumption_master_secret from the master secret. RFC 8446 Section 7.1: resumption_master_secret = Derive-Secret(Master Secret, \"res master\", ClientHello..client Finished)","ref":"quic_ticket.html#derive_resumption_secret/4"},{"type":"function","title":"quic_ticket.lookup_ticket/2","doc":"Look up a ticket for a server. Returns {ok, Ticket} if found and not expired, error otherwise.","ref":"quic_ticket.html#lookup_ticket/2"},{"type":"function","title":"quic_ticket.new_store/0","doc":"Create a new empty ticket store.","ref":"quic_ticket.html#new_store/0"},{"type":"function","title":"quic_ticket.parse_new_session_ticket/1","doc":"Parse a NewSessionTicket message from the server. RFC 8446 Section 4.6.1: struct { uint32 ticket_lifetime; uint32 ticket_age_add; opaque ticket_nonce<0..255>; opaque ticket<1..2^16-1>; Extension extensions<0..2^16-2>; } NewSessionTicket;","ref":"quic_ticket.html#parse_new_session_ticket/1"},{"type":"function","title":"quic_ticket.store_ticket/3","doc":"Store a session ticket for a server. The ticket is indexed by server name.","ref":"quic_ticket.html#store_ticket/3"},{"type":"extras","title":"erlang_quic","doc":"# erlang_quic\n\nPure Erlang QUIC implementation (RFC 9000/9001).","ref":"readme.html"},{"type":"extras","title":"Features - erlang_quic","doc":"- TLS 1.3 handshake (RFC 8446)\n- Stream multiplexing (bidirectional and unidirectional)\n- Key update support (RFC 9001 Section 6)\n- Connection migration (RFC 9000 Section 9)\n- 0-RTT early data support (RFC 9001 Section 4.6)\n- Server mode with listener\n- Flow control (connection and stream level)\n- Congestion control (NewReno)\n- Loss detection and packet retransmission (RFC 9002)","ref":"readme.html#features"},{"type":"extras","title":"Requirements - erlang_quic","doc":"- Erlang/OTP 26.0 or later\n- rebar3","ref":"readme.html#requirements"},{"type":"extras","title":"Installation - erlang_quic","doc":"Add to your `rebar.config` dependencies:\n\n```erlang\n{deps, [\n    {quic, {git, \"https://github.com/benoitc/erlang_quic.git\", {branch, \"main\"}}}\n]}.\n```","ref":"readme.html#installation"},{"type":"extras","title":"Quick Start - erlang_quic","doc":"","ref":"readme.html#quick-start"},{"type":"extras","title":"Client - erlang_quic","doc":"```erlang\n%% Connect to a QUIC server\n{ok, ConnRef} = quic:connect(<<\"example.com\">>, 443, #{\n    alpn => [<<\"h3\">>],\n    verify => false\n}, self()),\n\n%% Wait for connection\nreceive\n    {quic, ConnRef, {connected, Info}} ->\n        io:format(\"Connected: ~p~n\", [Info])\nend,\n\n%% Open a bidirectional stream\n{ok, StreamId} = quic:open_stream(ConnRef),\n\n%% Send data on the stream\nok = quic:send_data(ConnRef, StreamId, <<\"Hello, QUIC!\">>, true),\n\n%% Receive data\nreceive\n    {quic, ConnRef, {stream_data, StreamId, Data, _Fin}} ->\n        io:format(\"Received: ~p~n\", [Data])\nend,\n\n%% Close connection\nquic:close(ConnRef, normal).\n```","ref":"readme.html#client"},{"type":"extras","title":"Server - erlang_quic","doc":"```erlang\n%% Load certificate and key\n{ok, CertDer} = file:read_file(\"server.crt\"),\n{ok, KeyDer} = file:read_file(\"server.key\"),\n\n%% Start listener\n{ok, Listener} = quic_listener:start_link(4433, #{\n    cert => CertDer,\n    key => KeyDer,\n    alpn => [<<\"h3\">>]\n}),\n\n%% Get the port (useful if 0 was specified)\nPort = quic_listener:get_port(Listener),\nio:format(\"Listening on port ~p~n\", [Port]),\n\n%% Incoming connections are handled automatically\n%% The listener spawns quic_connection processes for each client\n```","ref":"readme.html#server"},{"type":"extras","title":"Messages - erlang_quic","doc":"The owner process receives messages in the format `{quic, ConnRef, Event}`:\n\n| Event | Description |\n|-------|-------------|\n| `{connected, Info}` | Connection established |\n| `{stream_opened, StreamId}` | New stream opened by peer |\n| `{stream_data, StreamId, Data, Fin}` | Data received on stream |\n| `{stream_reset, StreamId, ErrorCode}` | Stream reset by peer |\n| `{closed, Reason}` | Connection closed |\n| `{transport_error, Code, Reason}` | Transport error |\n| `{session_ticket, Ticket}` | Session ticket for 0-RTT |","ref":"readme.html#messages"},{"type":"extras","title":"API Reference - erlang_quic","doc":"","ref":"readme.html#api-reference"},{"type":"extras","title":"Connection - erlang_quic","doc":"- `quic:connect/4` - Connect to a QUIC server\n- `quic:close/2` - Close a connection\n- `quic:peername/1` - Get remote address\n- `quic:sockname/1` - Get local address","ref":"readme.html#connection"},{"type":"extras","title":"Streams - erlang_quic","doc":"- `quic:open_stream/1` - Open bidirectional stream\n- `quic:open_unidirectional_stream/1` - Open unidirectional stream\n- `quic:send_data/4` - Send data on stream\n- `quic:reset_stream/3` - Reset a stream","ref":"readme.html#streams"},{"type":"extras","title":"Server - erlang_quic","doc":"- `quic_listener:start_link/2` - Start a QUIC listener\n- `quic_listener:stop/1` - Stop listener\n- `quic_listener:get_port/1` - Get listening port\n- `quic_listener:get_connections/1` - List active connections","ref":"readme.html#server-1"},{"type":"extras","title":"Building - erlang_quic","doc":"```bash\nrebar3 compile\n```","ref":"readme.html#building"},{"type":"extras","title":"Testing - erlang_quic","doc":"```bash\n# Run unit tests\nrebar3 eunit\n\n# Run property-based tests\nrebar3 proper\n\n# Run all tests\nrebar3 eunit && rebar3 proper\n```","ref":"readme.html#testing"},{"type":"extras","title":"Documentation - erlang_quic","doc":"Generate documentation with:\n\n```bash\nrebar3 ex_doc\n```","ref":"readme.html#documentation"},{"type":"extras","title":"License - erlang_quic","doc":"Apache License 2.0","ref":"readme.html#license"},{"type":"extras","title":"Author - erlang_quic","doc":"Benoit Chesneau","ref":"readme.html#author"},{"type":"extras","title":"erlang_quic Design Document","doc":"# erlang_quic Design Document\n\nThis document describes the architecture and design of the erlang_quic implementation.","ref":"design.html"},{"type":"extras","title":"Architecture Overview - erlang_quic Design Document","doc":"The implementation is organized into the following module groups:","ref":"design.html#architecture-overview"},{"type":"extras","title":"Public API Layer - erlang_quic Design Document","doc":"| Module | Responsibility |\n|--------|----------------|\n| `quic` | Main public API for client connections |\n| `quic_listener` | Server-side listener for accepting connections |","ref":"design.html#public-api-layer"},{"type":"extras","title":"Connection Layer - erlang_quic Design Document","doc":"| Module | Responsibility |\n|--------|----------------|\n| `quic_connection` | Connection state machine (gen_statem) |\n| `quic_stream` | Stream state management |","ref":"design.html#connection-layer"},{"type":"extras","title":"Protocol Layer - erlang_quic Design Document","doc":"| Module | Responsibility |\n|--------|----------------|\n| `quic_packet` | Packet encoding/decoding |\n| `quic_frame` | Frame encoding/decoding |\n| `quic_varint` | Variable-length integer encoding (RFC 9000 Section 16) |","ref":"design.html#protocol-layer"},{"type":"extras","title":"Cryptography Layer - erlang_quic Design Document","doc":"| Module | Responsibility |\n|--------|----------------|\n| `quic_crypto` | Key derivation and transcript hashing |\n| `quic_tls` | TLS 1.3 message building and parsing |\n| `quic_keys` | Traffic key derivation |\n| `quic_aead` | AEAD encryption/decryption and header protection |\n| `quic_hkdf` | HKDF-based key expansion |","ref":"design.html#cryptography-layer"},{"type":"extras","title":"Flow Control Layer - erlang_quic Design Document","doc":"| Module | Responsibility |\n|--------|----------------|\n| `quic_flow` | Connection and stream flow control |\n| `quic_cc` | Congestion control (NewReno) |\n| `quic_loss` | Loss detection and recovery |\n| `quic_ack` | ACK frame processing and generation |","ref":"design.html#flow-control-layer"},{"type":"extras","title":"Session Layer - erlang_quic Design Document","doc":"| Module | Responsibility |\n|--------|----------------|\n| `quic_ticket` | Session ticket storage and PSK derivation |","ref":"design.html#session-layer"},{"type":"extras","title":"Connection Lifecycle - erlang_quic Design Document","doc":"```\n                    \n                      idle   \n                    \n                          send ClientHello\n                         \n                  \n                   handshaking  \n                  \n                          receive server Finished\n                          send client Finished\n                         \n                  \n                    connected   \n                           \n                                           key update\n                                           migration\n                         \n                          close/error\n                         \n                  \n                     draining   \n                  \n                          drain timeout\n                         \n                    \n                     closed  \n                    \n```","ref":"design.html#connection-lifecycle"},{"type":"extras","title":"State Descriptions - erlang_quic Design Document","doc":"- **idle**: Initial state, preparing to connect\n- **handshaking**: TLS 1.3 handshake in progress\n- **connected**: Connection established, data transfer active\n- **draining**: Connection closing, processing remaining packets\n- **closed**: Connection terminated","ref":"design.html#state-descriptions"},{"type":"extras","title":"Packet Processing - erlang_quic Design Document","doc":"","ref":"design.html#packet-processing"},{"type":"extras","title":"Encryption Levels - erlang_quic Design Document","doc":"QUIC uses four encryption levels, each with its own keys:\n\n| Level | Usage |\n|-------|-------|\n| Initial | ClientHello, ServerHello (derived from DCID) |\n| Handshake | EncryptedExtensions through Finished |\n| 0-RTT | Early data (optional, from session resumption) |\n| 1-RTT | Application data after handshake |","ref":"design.html#encryption-levels"},{"type":"extras","title":"Packet Types - erlang_quic Design Document","doc":"**Long Header Packets:**\n- Initial (type 0x00)\n- 0-RTT (type 0x01)\n- Handshake (type 0x02)\n- Retry (type 0x03)\n\n**Short Header Packets:**\n- 1-RTT (application data)","ref":"design.html#packet-types"},{"type":"extras","title":"Frame Processing - erlang_quic Design Document","doc":"Frames are processed in order within a packet. Key frame types:\n\n| Frame Type | Description |\n|------------|-------------|\n| PADDING (0x00) | Padding for packet size |\n| PING (0x01) | Keep-alive |\n| ACK (0x02-0x03) | Acknowledgment |\n| CRYPTO (0x06) | TLS handshake data |\n| STREAM (0x08-0x0f) | Stream data |\n| MAX_DATA (0x10) | Connection flow control |\n| MAX_STREAM_DATA (0x11) | Stream flow control |\n| NEW_CONNECTION_ID (0x18) | Issue new CID |\n| PATH_CHALLENGE (0x1a) | Path validation |\n| PATH_RESPONSE (0x1b) | Path validation response |\n| CONNECTION_CLOSE (0x1c-0x1d) | Close connection |","ref":"design.html#frame-processing"},{"type":"extras","title":"TLS Integration - erlang_quic Design Document","doc":"","ref":"design.html#tls-integration"},{"type":"extras","title":"Handshake Flow (Client) - erlang_quic Design Document","doc":"```\nClient                                  Server\n                                         \n   Initial[ClientHello] \n                                         \n   Initial[ServerHello] \n   Handshake[EncryptedExtensions] \n   Handshake[Certificate] \n   Handshake[CertificateVerify] \n   Handshake[Finished] \n                                         \n   Handshake[Finished] \n                                         \n   1-RTT[Application Data] \n```","ref":"design.html#handshake-flow-client"},{"type":"extras","title":"Key Derivation - erlang_quic Design Document","doc":"Keys are derived using HKDF with the following hierarchy:\n\n```\n                    PSK (or 0)\n                        \n                        \n                 \n                  Early Secret\n                 \n                        \n          \n                                    \n    client_early    binder_key    res_secret\n    traffic_secret                    \n                                      \n                                     \n                     \n    (EC)DHEHandshake Secret      \n                     \n                                     \n         \n                                   \n   client_hs      server_hs    derived\n   traffic        traffic            \n   secret         secret             \n                                     \n                        \n                        Master Secret\n                        \n                               \n              \n                                              \n        client_app         server_app      resumption\n        traffic            traffic         master\n        secret             secret          secret\n```","ref":"design.html#key-derivation"},{"type":"extras","title":"Stream Management - erlang_quic Design Document","doc":"","ref":"design.html#stream-management"},{"type":"extras","title":"Stream IDs - erlang_quic Design Document","doc":"Stream IDs encode initiator and directionality:\n\n| Bits 1-0 | Stream Type |\n|----------|-------------|\n| 0x00 | Client-initiated, bidirectional |\n| 0x01 | Server-initiated, bidirectional |\n| 0x02 | Client-initiated, unidirectional |\n| 0x03 | Server-initiated, unidirectional |","ref":"design.html#stream-ids"},{"type":"extras","title":"Stream States - erlang_quic Design Document","doc":"**Sending side:**\n- Ready  Send  Data Sent  Data Recvd (terminal)\n- Ready  Reset Sent  Reset Recvd (terminal)\n\n**Receiving side:**\n- Recv  Size Known  Data Recvd  Data Read (terminal)\n- Recv  Reset Recvd  Reset Read (terminal)","ref":"design.html#stream-states"},{"type":"extras","title":"Flow Control - erlang_quic Design Document","doc":"","ref":"design.html#flow-control"},{"type":"extras","title":"Connection-Level - erlang_quic Design Document","doc":"- `MAX_DATA` frame advertises connection-level receive window\n- Sender tracks `data_sent` against peer's `max_data`\n- Receiver sends `MAX_DATA` updates when buffer space is freed","ref":"design.html#connection-level"},{"type":"extras","title":"Stream-Level - erlang_quic Design Document","doc":"- `MAX_STREAM_DATA` frame advertises per-stream receive window\n- Similar tracking at stream granularity\n- `BLOCKED` and `STREAM_BLOCKED` frames signal flow control limits","ref":"design.html#stream-level"},{"type":"extras","title":"Congestion Control - erlang_quic Design Document","doc":"The implementation uses NewReno congestion control (RFC 9002):","ref":"design.html#congestion-control"},{"type":"extras","title":"States - erlang_quic Design Document","doc":"- **Slow Start**: Exponential growth until `ssthresh`\n- **Congestion Avoidance**: Linear growth after slow start\n- **Recovery**: After packet loss detection","ref":"design.html#states"},{"type":"extras","title":"Key Variables - erlang_quic Design Document","doc":"| Variable | Description |\n|----------|-------------|\n| `cwnd` | Congestion window (bytes) |\n| `ssthresh` | Slow start threshold |\n| `bytes_in_flight` | Unacknowledged bytes |","ref":"design.html#key-variables"},{"type":"extras","title":"On ACK - erlang_quic Design Document","doc":"```\nif bytes_acked > 0:\n    if cwnd < ssthresh:\n        cwnd += bytes_acked  # Slow start\n    else:\n        cwnd += (bytes_acked * max_datagram_size) / cwnd  # Congestion avoidance\n```","ref":"design.html#on-ack"},{"type":"extras","title":"On Loss - erlang_quic Design Document","doc":"```\nssthresh = max(cwnd / 2, 2 * max_datagram_size)\ncwnd = ssthresh\n```","ref":"design.html#on-loss"},{"type":"extras","title":"Loss Detection - erlang_quic Design Document","doc":"","ref":"design.html#loss-detection"},{"type":"extras","title":"Packet Loss Detection - erlang_quic Design Document","doc":"Two mechanisms detect packet loss:\n\n1. **Packet Threshold**: A packet is lost if a later packet in the same number space has been acknowledged and the gap exceeds the threshold (default: 3).\n\n2. **Time Threshold**: A packet is lost if it was sent more than `max(smoothed_rtt + max(4 * rtt_var, 1ms), 1.125 * smoothed_rtt)` before the largest acknowledged packet.","ref":"design.html#packet-loss-detection"},{"type":"extras","title":"Probe Timeout (PTO) - erlang_quic Design Document","doc":"When no ACKs are received, PTO triggers retransmission:\n\n```\nPTO = smoothed_rtt + max(4 * rtt_var, 1ms) + max_ack_delay\n```\n\nAfter PTO expires:\n1. Send 1-2 ack-eliciting packets\n2. Double PTO for next timeout\n3. After persistent congestion, reset to slow start","ref":"design.html#probe-timeout-pto"},{"type":"extras","title":"Connection Migration - erlang_quic Design Document","doc":"","ref":"design.html#connection-migration"},{"type":"extras","title":"Path Validation - erlang_quic Design Document","doc":"When the peer's address changes:\n\n1. Send `PATH_CHALLENGE` frame with random 8-byte data\n2. Peer responds with `PATH_RESPONSE` containing same data\n3. Path is validated upon receiving correct response","ref":"design.html#path-validation"},{"type":"extras","title":"Migration Process - erlang_quic Design Document","doc":"1. Detect new remote address\n2. Initiate path validation\n3. Continue using old path until validation completes\n4. Switch to new path upon successful validation\n5. Reset congestion controller for new path","ref":"design.html#migration-process"},{"type":"extras","title":"Key Update - erlang_quic Design Document","doc":"RFC 9001 Section 6 defines key update mechanism:\n\n1. Sender increments key phase bit in packet header\n2. Derives new keys from current application secrets\n3. Receiver detects phase change and derives matching keys\n4. Old keys retained briefly for reordered packets\n\n```\nnext_app_secret = HKDF-Expand-Label(current_app_secret, \"quic ku\", \"\", hash_len)\n```","ref":"design.html#key-update"},{"type":"extras","title":"Connection ID Management - erlang_quic Design Document","doc":"","ref":"design.html#connection-id-management"},{"type":"extras","title":"Local CID Pool - erlang_quic Design Document","doc":"- Generate and issue CIDs via `NEW_CONNECTION_ID` frame\n- Track sequence numbers and stateless reset tokens\n- Retire old CIDs via `RETIRE_CONNECTION_ID`","ref":"design.html#local-cid-pool"},{"type":"extras","title":"Peer CID Pool - erlang_quic Design Document","doc":"- Store CIDs received from peer\n- Select appropriate CID for path\n- Respect `active_connection_id_limit` transport parameter","ref":"design.html#peer-cid-pool"}],"proglang":"erlang","content_type":"text/markdown","producer":{"name":"ex_doc","version":"0.39.1"}}